<!DOCTYPE html>
<html>

<head>
    <!-- <script src="https://cdn.cloudinary.com/sdk/js/cloudinary-core-shrinkwrap.min.js"></script> -->
</head>

<body>

    <button id="upload_widget" class="cloudinary-button">Upload files</button>
    <button onclick="sendFile()">send file</button>

    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>

    <script type="text/javascript">
        function sendFile(){
            console.log("first")
        }
        var myWidget = cloudinary.createUploadWidget({
            // cloudName: 'dvvzlzude',
            // uploadPreset: 'espotpxe'
        }, (error, result) => {
            if (!error && result && result.event === "success") {
                console.log('Done! Here is the image info: ', result.info.url);
                let url=result.info.url;
                const request=new XMLHttpRequest()
                request.open("POST",`/ProcessDoc/${JSON.stringify(url)}` )
                request.send();
            }else{
                console.log("err" ,error)
                let url=result.info.url;
                const request=new XMLHttpRequest()
                request.open("POST",`/ProcessDoc/${JSON.stringify(url)}` )
                request.send();

            }
        }
        )

        document.getElementById("upload_widget").addEventListener("click", function () {
            myWidget.open();
        }, false);
    </script>

</body>

</html>